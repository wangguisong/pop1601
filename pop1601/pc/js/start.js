//验证相关参数var userID;var webAppId;var timeOffset;var testName;var nodeId;var errnodeId;var solo = "solo/solo.html";var wrong = "wrong/wrong.html";var showAny = "showAny/showAny.html";$(document).ready(function(){	userID = getQuery("userID");	webAppId = getQuery("webAppId");	timeOffset = getQuery("timeOffset");	if(userID==null||webAppId==null||timeOffset==null){		alert("参数错误");		return;	}	var serverIp = getQuery("serverIp");    if(serverIp && serverIp!=""){        URL = serverIp + "actionService/gateway";    }    testName = decodeURIComponent(decodeURIComponent(getQuery("testName")));    nodeId = decodeURIComponent(decodeURIComponent(getQuery("nodeId")));    errnodeId = decodeURIComponent(decodeURIComponent(getQuery("errnodeId")));    $("#startDiv.title").html(testName);    //获取分数    getScoreWithTest();	onResize();	//窗口获得焦点事件	$(window).focus(function(){	  getScoreWithTest();		});})$(window).resize(onResize);function onResize(){	layoutStartDiv();}function layoutStartDiv(){	 allH = $(window).height();	 $("#startDiv").height(allH-44);}/*鼠标经过开始考试按钮的动画效果*/function startBtnHover(){	$(".startBtn").mouseover(function(){		goBtnMoveR();	});	$(".stDiv").mouseleave(function(){		goBtnMoveL();	});}/*向右移入*/function goBtnMoveR(){	$(".goBtn").stop().animate({		left:'0px',	},200);}/*向左移出*/function goBtnMoveL(){	$(".goBtn").stop().animate({		left:'-92px',	},200);}/*鼠标经过开始考试按钮的动画效果*/function startBtnHover2(){	$(".startBtn2").mouseover(function(){		goBtnMoveR2();	});	$(".stDiv2").mouseleave(function(){
		goBtnMoveL2();
	});}/*向右移入*/function goBtnMoveR2(){	$(".goBtn2").stop().animate({		left:'0px',	},200);}/*向左移出*/function goBtnMoveL2(){	$(".goBtn2").stop().animate({		left:'-92px',	},200);}//获取分数方法function getScoreWithTest(){	$(".beginDiv").remove();	$(".showScore").remove();	//显示为考试部分	$("#startDiv").append('<div class="beginDiv"></div>');	$(".beginDiv").append('<div class="circle"></div>');	$(".circle").append('<img src="img/notTest.png">');	$(".beginDiv").append('<div class="stDiv"></div>');	$(".stDiv").append('<div class="goBtn">GO</div>');	$(".stDiv").append('<div class="startBtn">开始考试</div>');	/*鼠标经过开始考试按钮的动画效果*/	startBtnHover();	//开始考试按钮点击事件	$(".goBtn").click(function(){        var param = "?nodeId="+nodeId+"&testName="+testName+"&pathURL="+URL    			+"&userId="+userID+"&webAppId="+webAppId+"&appPwd="+appPwd+"&timeOffset="+timeOffset;        var soloURL = encodeURI(solo+param);        window.open(encodeURI(soloURL));    });    /************      请求分数             ************/	request("SwfTestService","getTestResult",	{nodeId:nodeId},	   function(data){		 if(data.realScore != undefined){	 	    $(".beginDiv").remove();            $(".showScore").remove();            //显示分数部分            $("#startDiv").append('<div class="showScore"></div>');	 		$(".showScore").append('<div id="indicatorContainer"></div>');	 		$("#indicatorContainer").append('<div class="whiteCirlce"></div>');	 		$("#indicatorContainer").append('<span>分</span>');	 		$(".showScore").append('<div class="btns"></div>');	 		$(".btns").append('<div class="stDiv2"></div>');	 		$(".stDiv2").append('<div class="goBtn2">go</div>');	 		$(".stDiv2").append('<div class="startBtn2">开始考试</div>');	 		$(".btns").append('<div class="wrongReportBtn">错题记录</div>');	 	    $("#indicatorContainer").radialIndicator({	         barBgColor:'#ffffff',	         barColor: '#f5af36',	         barWidth:2,	         radius:88,	         maxValue:data.planScore,            });            var radialObj = $('#indicatorContainer').data('radialIndicator');            radialObj.animate(data.realScore);            startBtnHover2();            //开始考试            $('.goBtn2').click(function(){            	var path = "XXXXXX";
            	var param = "?nodeId="+nodeId+"&testName="+testName+"&pathURL="+URL
			       +"&userId="+userID+"&webAppId="+webAppId+"&appPwd="+appPwd+"&timeOffset="+timeOffset;
                var soloURL = encodeURI(solo+param);
                window.open(encodeURI(soloURL));            });            //错题记录            showMistake();            //试卷精析            testAny();		 }	   }//	   function(msg){
//			alert(msg);
//	   }	);}/*错题记录跳转*/function showMistake(){	$(".wrongReportBtn").click(function(){		var param = "?nodeId="+errnodeId+"&testName="+testName+"&pathURL="+URL	            			+"&userId="+userID+"&webAppId="+webAppId+"&appPwd="+appPwd+"&timeOffset="+timeOffset;	           				    var wrongURL = encodeURI(wrong+param);	    window.open(encodeURI(wrongURL));	});}/*试卷精析*/function testAny(){    var data = createRequestVars();    data.serviceName = "YunTestService";    data.methodName = "getAppSyncExecContactById";    data.nodeId = nodeId;    doAjax(URL,data,function(data){    //******************** 节点数据请求成功 START ********************      var json = eval("(" + data + ")");      if(json.success=="0"){         var str = decodeURIComponent(json.data[0].question);         if(str!=""){//	       $(".btns").append('<div class="testAny">试卷精析</div>');	       //试卷精析	       $(".testAny").click(function(){    	      var param = "?nodeId="+nodeId+"&testName="+testName+"&pathURL="+URL    			+"&userId="+userID+"&webAppId="+webAppId+"&appPwd="+appPwd+"&timeOffset="+timeOffset;              var showAnyURL = encodeURI(showAny+param);              window.open(encodeURI(showAnyURL));           });         }else{           $("#testAny").removeClass("testAny").addClass("testAnyDisabled");	           $(".testAnyDisabled").attr("disabled",true);         }      }     });    }